#!/usr/bin/env node

import chalk from 'chalk'
//import clear from 'clear'
import figlet from 'figlet'
import path from 'path'
import program from 'commander'
import Configstore from 'configstore'


//clear();

console.log(
  chalk.green(
    figlet.textSync('cpln', { horizontalLayout: 'full' })
  )
);

program
    .version('1.0.1')
    .description("Control Plane Corporation CLI")
    .option('-l, --login <username>', 'Login')
    .option('-g, --create-gvc', 'Create a GVC (Global Virtual Cloud)')
    .option('-e, --environment <environment>', 'Specify the environment, default is prod')
    .parse(process.argv)

    const config = new Configstore('cpln');

    
    if (program.environment) {
        let env = program.environment
        config.set('environment', env)
    }
    
    let environment! : string
    environment = config.get('environment')
    
    if (!environment) {
        environment = 'prod'
        config.set('environment', environment)
    }    

    console.log(`ENVIRONMENT: ${environment}`)

    const creds = new Configstore(`cpln-${environment}`)
   
    if (program.login) {
        let key = program.login
        creds.set('key', key)
    }

    if (!process.argv.slice(2).length) {
        let key = creds.get('key')
        if (!key) {
            console.log('You must provide a key, use cpln -login <key>')
        }
        program.outputHelp();
      }

      